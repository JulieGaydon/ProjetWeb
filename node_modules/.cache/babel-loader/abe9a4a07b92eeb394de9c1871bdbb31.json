{"ast":null,"code":"import _slicedToArray from \"/home/julie/Documents/Julie/L3Info/Web/ProjetWeb/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/julie/Documents/Julie/L3Info/Web/ProjetWeb/src/ProfilAmi.js\";\nimport React, { useEffect, useState } from 'react';\nimport Message from './Message';\nimport axios from 'axios';\nimport Logout from './Logout';\nimport './Profil.css';\nimport FormAddMessage from './FormAddMessage';\nimport ProfilModif from './ProfilModif';\nimport MurDeTweets from './MurDeTweets';\n\nfunction ProfilAmi(_ref) {\n  var CallBackChangeEtat = _ref.CallBackChangeEtat,\n      PPpseudo = _ref.PPpseudo,\n      pseudoA = _ref.pseudoA,\n      setClic = _ref.setClic;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      posts = _useState2[0],\n      setPosts = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      pseudo = _useState4[0],\n      setPseudo = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      mdt = _useState6[0],\n      setMur = _useState6[1]; // const[dejaAmi, setDejaAmi] = useState(false);\n  // const[Pami, addAmi] = useState([]);\n\n\n  var ajouter = function ajouter() {\n    var instance = axios.create({\n      baseURL: 'http://localhost:4000/',\n      timeout: 5000,\n      headers: {\n        'X-Custom-Header': 'foobar'\n      }\n    }); // on recupere les liens d'amitie\n\n    instance.get('api/ami/' + PPpseudo).then(function (response) {\n      //response.data liste de tous les messages\n      alert(\"resultat response :\", response.data);\n      console.log(\"resultat response :\", response.data);\n      var i = 0;\n      var dejaAmi = false; // on regarde si on est ami avec la personne\n\n      while (response.data[i] != undefined) {\n        console.log(\"response.data[i].pami\", response.data[i].pami);\n\n        if (pseudoA == response.data[i].pami) {\n          console.log(\"deja ami\");\n          dejaAmi = true; // on supprime lien amitier\n\n          instance.delete('api/ami/' + PPpseudo).then(function (response) {\n            console.log(\"resultat\", response);\n            alert(response);\n          }).catch(function (error) {\n            console.log(error);\n            alert(\"error\", error);\n          });\n          break;\n        }\n\n        i = i + 1;\n      }\n\n      console.log(\"deja ami\", dejaAmi); // si on est pas ami, on creer le lien d'amitie\n\n      if (dejaAmi == false) {\n        instance.put('api/ami', {\n          Pseudo: PPpseudo,\n          Pami: pseudoA\n        }).then(function (response) {\n          console.log(\"resultat\", response);\n          alert(response);\n        }).catch(function (error) {\n          console.log(error);\n          alert(\"error\", error);\n        });\n      }\n\n      console.log(\"data pas vide : existe lien\");\n    }).catch(function (error) {\n      alert(\"fonction get ami\", error);\n      console.log(error);\n    });\n  }; // recuperer message du profil ami\n\n\n  useEffect(function () {\n    var p = {\n      pseudoA: pseudoA\n    };\n    console.log(\"PPp: \", pseudoA); // setPseudo(p.PPpseudo)\n\n    var instance = axios.create({\n      baseURL: 'http://localhost:4000/',\n      timeout: 1000,\n      headers: {\n        'X-Custom-Header': 'foobar'\n      }\n    });\n    instance.get('api/message/' + p.pseudoA).then(function (response) {\n      //response.data liste de tous les messages\n      console.log(\"retourne :\", response.data); //doc = 1message\n\n      setPosts(response.data.map(function (doc) {\n        return doc;\n      }));\n    }).catch(function (error) {\n      console.log(\"message pas bon\");\n      alert(error);\n      console.log(error);\n    });\n  }, []);\n\n  if (mdt == true) {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, React.createElement(MurDeTweets, {\n      CallBackChangeEtat: CallBackChangeEtat,\n      PPpseudo: PPpseudo,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }));\n  } else {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, React.createElement(\"fieldset\", {\n      id: \"Profil\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"enteteP\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      type: \"button\",\n      id: \"bouttonMdT\",\n      onClick: function onClick() {\n        return setMur(true);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, \"Mur\"), React.createElement(Logout, {\n      CallBackChangeEtat: CallBackChangeEtat,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      id: \"mess\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, console.log(\"post:\", posts), posts.map(function (post) {\n      return React.createElement(Message, {\n        key: post._id,\n        pseudo: post.pseudo,\n        message: post.message,\n        setClic: setClic,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      });\n    })), React.createElement(\"div\", {\n      id: \"infoP\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      type: \"button\",\n      id: \"bouttonProfil\",\n      onClick: ajouter,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, \"Ajouter\"))));\n  }\n}\n\nexport default ProfilAmi;","map":{"version":3,"sources":["/home/julie/Documents/Julie/L3Info/Web/ProjetWeb/src/ProfilAmi.js"],"names":["React","useEffect","useState","Message","axios","Logout","FormAddMessage","ProfilModif","MurDeTweets","ProfilAmi","CallBackChangeEtat","PPpseudo","pseudoA","setClic","posts","setPosts","pseudo","setPseudo","mdt","setMur","ajouter","instance","create","baseURL","timeout","headers","get","then","response","alert","data","console","log","i","dejaAmi","undefined","pami","delete","catch","error","put","Pseudo","Pami","p","map","doc","post","_id","message"],"mappings":"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","sourcesContent":["import React, { useEffect ,useState } from 'react';\nimport Message from './Message';\nimport axios from 'axios';\nimport Logout from './Logout';\nimport './Profil.css';\nimport FormAddMessage from './FormAddMessage';\nimport ProfilModif from './ProfilModif'\nimport MurDeTweets from './MurDeTweets';\n\nfunction ProfilAmi ({CallBackChangeEtat, PPpseudo, pseudoA, setClic}){\n    const[posts, setPosts] = useState([]);\n    const[pseudo, setPseudo] = useState([]);\n    const[mdt, setMur] = useState(false);\n    // const[dejaAmi, setDejaAmi] = useState(false);\n    // const[Pami, addAmi] = useState([]);\n\n    const ajouter =() =>{\n        const instance = axios.create({\n            baseURL: 'http://localhost:4000/',\n            timeout: 5000,\n            headers: {'X-Custom-Header': 'foobar'}\n        });\n        // on recupere les liens d'amitie\n        instance.get('api/ami/'+PPpseudo)\n        .then(function (response){\n            //response.data liste de tous les messages\n            alert(\"resultat response :\",response.data)\n            console.log(\"resultat response :\",response.data)\n            let i=0\n            let dejaAmi = false\n            // on regarde si on est ami avec la personne\n            while(response.data[i] != undefined){\n                console.log(\"response.data[i].pami\",response.data[i].pami)\n                if(pseudoA == response.data[i].pami){\n                    console.log(\"deja ami\")\n                    dejaAmi = true\n                    // on supprime lien amitier\n                    instance.delete('api/ami/'+PPpseudo)\n                    .then(function (response){\n                        console.log(\"resultat\",response)\n                        alert(response)\n                    })\n                    .catch(function (error){\n                        console.log(error)\n                        alert(\"error\",error)\n                    })\n                    \n                    break\n                }\n                i = i+1\n            }\n            console.log(\"deja ami\",dejaAmi)\n            // si on est pas ami, on creer le lien d'amitie\n            if(dejaAmi == false){\n                instance.put('api/ami',{ Pseudo :PPpseudo, Pami : pseudoA})\n                .then(function (response){\n                    console.log(\"resultat\",response)\n                    alert(response)\n                })\n                .catch(function (error){\n                    console.log(error)\n                    alert(\"error\",error)\n                })\n            }\n            console.log(\"data pas vide : existe lien\")\n        })\n        .catch(function (error){\n            alert(\"fonction get ami\",error)\n            console.log(error)\n        })\n\n    }\n    \n    // recuperer message du profil ami\n    useEffect(()=>{\n        let p = {pseudoA}\n        console.log(\"PPp: \",pseudoA)\n        // setPseudo(p.PPpseudo)\n        const instance = axios.create({\n            baseURL: 'http://localhost:4000/',\n            timeout: 1000,\n            headers: {'X-Custom-Header': 'foobar'}\n        });\n        instance.get('api/message/'+p.pseudoA)\n        .then(function (response){\n            //response.data liste de tous les messages\n            console.log(\"retourne :\",response.data)\n            //doc = 1message\n            setPosts(response.data.map((doc) => doc))\n        })\n        .catch(function (error){\n            console.log(\"message pas bon\")\n            alert(error)\n            console.log(error)\n        })\n    },[])\n\n    if (mdt == true){\n        return(\n            <div>\n               <MurDeTweets CallBackChangeEtat = {CallBackChangeEtat} PPpseudo = {PPpseudo}/>\n            </div>\n        )\n    }\n    else{\n        return(<div>\n            <fieldset id = \"Profil\">\n                <div id=\"enteteP\">\n                    <button type=\"button\" id = \"bouttonMdT\" onClick={()=>setMur(true)}>Mur</button>\n                    <Logout CallBackChangeEtat = {CallBackChangeEtat}/>\n                </div> \n                <div id=\"mess\">\n                    {console.log(\"post:\",posts)}\n                    {posts.map((post) => (\n                        <Message key = {post._id} pseudo = {post.pseudo} message = {post.message} setClic= {setClic}/>\n                    ))}\n                </div>\n                <div id=\"infoP\">\n                    <button type = \"button\" id = \"bouttonProfil\" onClick={ajouter}>Ajouter</button>\n                </div>\n                        \n            </fieldset>\n            </div>\n            )\n    }\n}\n\nexport default ProfilAmi;"]},"metadata":{},"sourceType":"module"}